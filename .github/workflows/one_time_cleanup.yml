name: 一次性清理脚本 (用完即删)

on: 
  workflow_dispatch: # 只有手动点击按钮才会运行

permissions:
  contents: write

jobs:
  cleanup:
    runs-on: ubuntu-latest
    steps:
      - name: 检出代码
        uses: actions/checkout@v4

      - name: 执行精准删除
        run: |
          echo "正在检查并删除 icon 根目录下以 -emby.png 结尾的文件..."
          # -maxdepth 1 保证只看根目录，不进 emby 文件夹
          # ! -name "emby.png" 保证绝对不删 emby.png
          find icon -maxdepth 1 -name "*-emby.png" ! -name "emby.png" -type f -print -delete
          echo "清理完成。"

      - name: 提交并推送到仓库
        run: |
          git config --local user.email "actions@github.com"
          git config --local user.name "GitHub Actions"
          git add .
          git commit -m "chore: 执行一次性根目录图片清理" || echo "没有发现需要清理的文件"
          git push
